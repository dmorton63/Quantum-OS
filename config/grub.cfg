### Enable serial console so GRUB prints to QEMU's -serial stdio
serial --unit=0 --speed=115200 --word=8 --parity=no --stop=1
terminal_input serial console
/* Also enable output to the normal console (VGA) so GRUB displays on
 * both serial and framebuffer when available. This gives a fallback
 * when testing with -nographic vs a windowed QEMU session. */
terminal_output serial console

/* Helpful modules and root search to make sure GRUB can find the
 * multiboot kernel on the ISO regardless of filesystem layout. */
insmod part_msdos
insmod iso9660
# Try to locate the kernel file and set root accordingly
search --file --set=root /boot/quantum_os.elf

set timeout=10
set default=2

menuentry "QuantumOS (Silent Mode)" {
set gfxmode=1024x768x32
set gfxpayload=1024x768x32
  multiboot /boot/quantum_os.elf verbosity=silent
  boot
}

menuentry "QuantumOS (Normal Mode)" {
set gfxmode=1024x768x32
set gfxpayload=1024x768x32
  multiboot /boot/quantum_os.elf verbosity=minimal
  boot
}

menuentry "QuantumOS (Verbose Mode)" {
set gfxmode=1024x768x32
set gfxpayload=1024x768x32
  multiboot /boot/quantum_os.elf verbosity=verbose
  boot
}

menuentry "Video Test" {
    set gfxmode=1024x768x32
    set gfxpayload=keep
    echo "GRUB mode set to 1024x768x32"
    videoinfo
    sleep 10
}

